# Story 2.2: One-Pager Navigation System

## Status
Ready for development

## Story
**As a** visitor,
**I want** smooth navigation within the one-page experience,
**so that** I can easily jump to different sections.

---

## Navigation Specifications

### Desktop Behavior
- **Traditional multi-page links:** /, /about, /contact
- **Fixed header:** Sticky navigation with backdrop blur effect
- **Theme toggle:** Sun/moon toggle button positioned in navigation
- **Typography:** Clean, uppercase navigation links with proper spacing

### Mobile Behavior
- **One-pager anchors:** /#about, /#contact (scroll to sections)
- **Mobile menu:** Collapsible navigation for small screens
- **Theme toggle:** Always visible, maintains position in mobile menu
- **Smooth scrolling:** Proper offset for fixed header positioning

### Visual Design
- **Backdrop blur:** Translucent header with blur effect
- **Typography:** Small, uppercase, letter-spaced navigation text
- **Theme toggle styling:** Circular button with sun/moon SVG icons
- **Section anchors:** Proper scroll-margin-top for fixed header offset

---

## Acceptance Criteria

1. **Fixed navigation header** with backdrop blur effect and proper z-index
2. **Desktop navigation:** Traditional links to standalone pages (/, /about, /contact)
3. **Mobile navigation:** Anchor links to sections (/#about, /#contact) for one-pager behavior
4. **Theme toggle button** with sun/moon icons and localStorage persistence
5. **Smooth scrolling** to sections with proper offset for fixed header
6. **Navigation styling** matches mockup: uppercase, letter-spaced, proper spacing
7. **Mobile menu functionality** with hamburger toggle and accessible implementation
8. **Responsive behavior** adapts navigation between desktop and mobile seamlessly
9. **Performance optimization** with proper component loading and state management
10. **Accessibility compliance** with ARIA labels, keyboard navigation, focus management

---

## Technical Implementation

### Component Structure
```
components/layout/header.tsx (enhanced)
├── Desktop navigation (multi-page links)
├── Mobile navigation (anchor-based)
├── Theme toggle component
└── Mobile menu state management

components/ui/theme-toggle.tsx (new)
├── Theme state management
├── localStorage persistence
├── Sun/moon icon switching
└── Accessibility features
```

### Navigation Configuration
```typescript
// Desktop: Traditional page navigation
const desktopNav = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/contact", label: "Contact" }
]

// Mobile: One-pager anchor navigation
const mobileNav = [
  { href: "/#about", label: "About" },
  { href: "/#contact", label: "Contact" }
]
```

### Theme Toggle Implementation
- **Client-side state management** with React hooks
- **localStorage persistence** for theme preference
- **System preference detection** as fallback
- **Before-paint theme initialization** to prevent flash
- **SVG icon switching** between sun and moon states

---

## Tasks / Subtasks

- [ ] **Enhance Header component for dual navigation behavior**
  - [ ] Implement desktop navigation with traditional page links
  - [ ] Add mobile navigation with anchor-based scrolling
  - [ ] Create responsive navigation switching logic
  - [ ] Apply backdrop blur and fixed positioning styling

- [ ] **Create theme toggle component**
  - [ ] Build theme-toggle.tsx with client-side state management
  - [ ] Implement localStorage theme persistence
  - [ ] Add system preference detection and fallback
  - [ ] Create sun/moon SVG icon switching functionality
  - [ ] Apply proper accessibility attributes and keyboard support

- [ ] **Implement mobile menu functionality**
  - [ ] Add mobile menu state management with useState hook
  - [ ] Create collapsible menu with smooth transitions
  - [ ] Implement hamburger button with proper ARIA attributes
  - [ ] Add touch-friendly menu interactions and close-on-select

- [ ] **Apply sophisticated navigation styling**
  - [ ] Implement backdrop blur with proper browser support detection
  - [ ] Add uppercase, letter-spaced typography for navigation links
  - [ ] Style theme toggle as circular button with hover effects
  - [ ] Apply Perfect Fifth spacing system to navigation elements

- [ ] **Configure anchor scrolling and section offsets**
  - [ ] Add scroll-margin-top CSS for proper section positioning
  - [ ] Implement smooth scrolling behavior with scroll-behavior CSS
  - [ ] Test anchor navigation with fixed header offset calculations
  - [ ] Ensure proper section visibility when navigating via anchors

- [ ] **Accessibility and performance optimization**
  - [ ] Add proper ARIA labels for navigation and theme toggle
  - [ ] Implement keyboard navigation support and focus management
  - [ ] Test screen reader compatibility and navigation announcements
  - [ ] Optimize component rendering and state management performance

---

## CSS Requirements

### Root-level anchor offset configuration:
```css
:root { --nav-h: 56px; }
[id] { scroll-margin-top: var(--nav-h); }
```

### Accessibility enhancements:
```css
:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

@media (prefers-reduced-motion: reduce) {
  * {
    animation: none !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
}
```

### Skip link for keyboard navigation:
```css
.sr-only.focus:not-sr-only {
  position: fixed;
  top: 2px;
  left: 2px;
  background: black;
  color: white;
  padding: 12px 16px;
  border-radius: 4px;
}
```

---

## Integration Points

### Layout Integration
- **Root layout (`app/layout.tsx`):** Include Header component and skip link
- **Homepage (`app/page.tsx`):** Add proper section IDs for anchor navigation
- **Standalone pages:** Traditional page routing for desktop navigation
- **Global CSS:** Include anchor offset and accessibility enhancements

### Theme Integration
- **Before-paint script:** Prevent theme flash with inline script in layout
- **CSS custom properties:** Theme-aware color tokens for navigation styling
- **Component compatibility:** Ensure all navigation elements support theme switching

### State Management
- **Theme toggle state:** Client-side state with localStorage persistence
- **Mobile menu state:** Simple useState pattern for menu open/close
- **Navigation state:** Responsive switching between desktop/mobile behavior

---

## Testing Requirements

### Manual Testing Checklist
- [ ] **Desktop navigation:** Test traditional page links (/, /about, /contact)
- [ ] **Mobile navigation:** Test anchor scrolling (/#about, /#contact)
- [ ] **Theme toggle:** Verify sun/moon switching and localStorage persistence
- [ ] **Mobile menu:** Test hamburger functionality and menu interactions
- [ ] **Responsive switching:** Verify navigation adapts between desktop/mobile
- [ ] **Anchor offsets:** Confirm proper section visibility with fixed header
- [ ] **Accessibility:** Test keyboard navigation and screen reader compatibility
- [ ] **Performance:** Verify smooth scrolling and responsive interactions

### Cross-Device Testing
- [ ] **Desktop browsers:** Chrome, Firefox, Safari, Edge
- [ ] **Mobile devices:** iOS Safari, Chrome Mobile, various screen sizes
- [ ] **Tablet devices:** iPad Safari, Android Chrome, landscape/portrait
- [ ] **Accessibility tools:** Screen readers, keyboard-only navigation

---

## Dev Notes

- **Dual navigation behavior:** Desktop uses traditional routing, mobile uses anchor scrolling
- **Theme toggle persistence:** localStorage with system preference fallback
- **Perfect Fifth spacing:** Apply design system tokens throughout navigation
- **Accessibility priority:** ARIA labels, keyboard support, focus management essential
- **Performance considerations:** Client components only where needed, optimize state updates
- **Responsive design:** Seamless adaptation between navigation behaviors